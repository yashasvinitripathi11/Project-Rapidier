{% load static %}
<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <link rel="apple-touch-icon" sizes="76x76" href="{% static 'img/apple-icon.png' %}">
  <link rel="icon" type="image/png" href="{% static 'img/favicon.png' %}">
  <title>
    Your Profile
  </title>
  <!--     Fonts and icons     -->
  <link href="https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700" rel="stylesheet" />
  <!-- Nucleo Icons -->
  <link href="{% static 'css/nucleo-icons.css' %}" rel="stylesheet" />
  <link href="{% static 'css/nucleo-svg.css' %}" rel="stylesheet" />
  <!-- Font Awesome Icons -->
  <script src="https://kit.fontawesome.com/42d5adcbca.js" crossorigin="anonymous"></script>
  <link href="{% static 'css/nucleo-svg.css' %}" rel="stylesheet" />
  <!-- CSS Files -->
  <link id="pagestyle" href="{% static 'css/argon-dashboard.css' %}" rel="stylesheet" />
</head>

<body class="g-sidenav-show bg-gray-100">
  <div class="position-absolute w-100 min-height-100 top-0">
    <img src="{{ student.banner_image.url }}" alt="" style="background-position-y: 50%; width: inherit; height: 20rem;
    ">
    <span class="mask bg-primary opacity-3"></span>
  </div>

  {% include 'dashboard/sidebar.html' %}

  <div class="main-content position-relative max-height-vh-100 h-100">
    <!-- Navbar -->
    <nav
      class="navbar navbar-main navbar-expand-lg bg-transparent shadow-none position-absolute px-4 w-100 z-index-2 mt-n11">
      <div class="container-fluid py-1">
        <nav aria-label="breadcrumb">
          <ol class="breadcrumb bg-transparent mb-0 pb-0 pt-1 ps-2 me-sm-6 me-5">
            <li class="breadcrumb-item text-sm"><a class="text-white opacity-5" href="javascript:;">{{ student.username
                }}</a></li>
            <li class="breadcrumb-item text-sm text-white active" aria-current="page">My Profile</li>
          </ol>
          <h6 class="text-white font-weight-bolder ms-2">{{ student.first_name}}'s Profile</h6>
        </nav>
        <div class="collapse navbar-collapse me-md-0 me-sm-4 mt-sm-0 mt-2" id="navbar">
          <div class="ms-md-auto pe-md-3 d-flex align-items-center">
            <div class="input-group">
              <span class="input-group-text text-body"><i class="fas fa-search" aria-hidden="true"></i></span>
              <input type="text" class="form-control" placeholder="Search here...">
            </div>
          </div>
          <ul class="navbar-nav justify-content-end">
            <li class="nav-item d-flex align-items-center">
              <a href="{% url 'logout' %}" class="nav-link text-white font-weight-bold px-0">
                <i class="fa fa-user me-sm-1"></i>
                <span class="d-sm-inline d-none">Log out</span>
              </a>
            </li>
            <li class="nav-item dropdown pe-2 d-flex align-items-center">
              <a href="javascript:;" class="nav-link text-white p-0" id="dropdownMenuButton" data-bs-toggle="dropdown"
                aria-expanded="false">
                <!-- <i class="fa fa-bell cursor-pointer"></i> -->
              </a>
            </li>
          </ul>
        </div>
      </div>
    </nav>
    <!-- End Navbar -->
    <div class="card shadow-lg mx-4 card-profile-bottom">
      <div class="card-body p-3">
        <div class="row gx-4">
          <div class="col-auto">
            <div class="avatar avatar-xl position-relative">
              <img src="{{ student.profile_pic.url }}" alt="profile_image" class="w-100 border-radius-lg shadow-sm">
            </div>
          </div>
          <div class="col-auto my-auto">
            <div class="h-100">
              <h5 class="mb-1">
                {{ student.first_name }} {{ student.last_name }}
              </h5>
              <p class="mb-0 font-weight-bold text-sm">
                {{ student.username }}
              </p>
            </div>
          </div>
          <!-- <div class="col-lg-4 col-md-6 my-sm-auto ms-sm-auto me-sm-0 mx-auto mt-3">
            <div class="nav-wrapper position-relative end-0">
              <ul class="nav nav-pills nav-fill p-1" role="tablist">
                <li class="nav-item">
                  <a class="nav-link mb-0 px-0 py-1 active d-flex align-items-center justify-content-center " data-bs-toggle="tab" href="javascript:;" role="tab" aria-selected="true">
                    <i class="ni ni-app"></i>
                    <span class="ms-2">App</span>
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link mb-0 px-0 py-1 d-flex align-items-center justify-content-center " data-bs-toggle="tab" href="javascript:;" role="tab" aria-selected="false">
                    <i class="ni ni-email-83"></i>
                    <span class="ms-2">Messages</span>
                  </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link mb-0 px-0 py-1 d-flex align-items-center justify-content-center " data-bs-toggle="tab" href="javascript:;" role="tab" aria-selected="false">
                    <i class="ni ni-settings-gear-65"></i>
                    <span class="ms-2">Settings</span>
                  </a>
                </li>
              </ul>
            </div>
          </div> -->
        </div>
      </div>
    </div>

    <div class="container-fluid py-4">

      {% for message in messages %}
      <div class="alert {{ message.tags }} alert-dismissible fade show" role="alert">
        <span class="alert-text text-white"><strong>{{ message.tag }}</strong>{{ message }}</span>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      {% endfor %}

      <div class="row">
        <div class="col-md-8">
          <div class="card">
            <div class="card-header pb-0">
              <div class="d-flex align-items-center">
                <p class="mb-0">Profile</p>
                <a class="btn btn-primary btn-sm ms-auto" href="{% url 'edit_profile' %}">Edit Profile</a>
              </div>
            </div>
            <div class="card-body">
              <p class="text-uppercase text-sm">User Information</p>
              <div class="row">
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="example-text-input" class="form-control-label">Username</label>
                    <input class="form-control" type="text"
                      value="{% if student.username %}{{student.username}}{% else %} NA {% endif %}" disabled>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="example-text-input" class="form-control-label">Email address</label>
                    <input class="form-control" type="email"
                      value="{% if student.email %}{{student.email}}{% else %} NA {% endif %}" disabled>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="example-text-input" class="form-control-label">First name</label>
                    <input class="form-control" type="text"
                      value="{% if student.first_name %}{{student.first_name}}{% else %} NA {% endif %}" disabled>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="example-text-input" class="form-control-label">Last name</label>
                    <input class="form-control" type="text"
                      value="{% if student.last_name %}{{student.last_name}}{% else %} NA {% endif %}" disabled>
                  </div>
                </div>
                <div class="col-md-6">
                  <div class="form-group">
                    <label for="example-text-input" class="form-control-label">Gender</label>
                    <input class="form-control" type="text"
                      value="{% if student.gender %}{{student.gender}}{% else %} NA {% endif %}" disabled>
                  </div>
                </div>
              </div>
              <hr class="horizontal dark">
              <p class="text-uppercase text-sm">Contact Information</p>
              <div class="row">
                <div class="col-md-4">
                  <div class="form-group">
                    <label for="example-text-input" class="form-control-label">Phone Number</label>
                    <input class="form-control" type="text"
                      value="{% if student.phone_number %}{{student.phone_number}}{% else %} NA {% endif %}" disabled>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="form-group">
                    <label for="example-text-input" class="form-control-label">Parents Phone Number</label>
                    <input class="form-control" type="text"
                      value="{% if student.parent_phone_number %}{{student.parent_phone_number}}{% else %} NA {% endif %}"
                      disabled>
                  </div>
                </div>
                <div class="col-md-12">
                  <div class="form-group">
                    <label for="example-text-input" class="form-control-label">Address</label>
                    <input class="form-control" type="text"
                      value="{% if student.address %}{{student.address}}{% else %} NA {% endif %}" disabled>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="form-group">
                    <label for="example-text-input" class="form-control-label">City</label>
                    <input class="form-control" type="text"
                      value="{% if student.city %}{{student.city}}{% else %} NA {% endif %}" disabled>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="form-group">
                    <label for="example-text-input" class="form-control-label">Country</label>
                    <input class="form-control" type="text"
                      value="{% if student.country %}{{student.country}}{% else %} NA {% endif %}" disabled>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="form-group">
                    <label for="example-text-input" class="form-control-label">Postal code</label>
                    <input class="form-control" type="text"
                      value="{% if student.postal_code %}{{student.postal_code}}{% else %} NA {% endif %}" disabled>
                  </div>
                </div>
              </div>
              <hr class="horizontal dark">
              <p class="text-uppercase text-sm">About me</p>
              <div class="row">
                <div class="col-md-12">
                  <div class="form-group">
                    <label for="example-text-input" class="form-control-label">About me</label>
                    <textarea class="form-control" cols="30" rows="3"
                      disabled>{% if student.bio %}{{student.bio}}{% else  %} NA {% endif %}</textarea>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- ======================================================================================= -->
        <!-- ======================================================================================= -->

        <div class="col-md-4">
          <div class="card card-profile">
            <img src="{{ student.banner_image.url }}" alt="Image placeholder" class="card-img-top">
            <div class="row justify-content-center">
              <div class="col-4 col-lg-4 order-lg-2">
                <div class="mt-n4 mt-lg-n6 mb-4 mb-lg-0">
                  <a href="javascript:;">
                    <img src="{{ student.profile_pic.url }}"
                      class="rounded-circle img-fluid border border-2 border-white">
                  </a>
                </div>
              </div>
            </div>

            <div id="main_card" style="display: block;">

              <!-- ============ dono button vala ================== -->

              <div class="card-header text-center border-0 pt-0 pt-lg-2 pb-4 pb-lg-3">
                <div class="d-flex justify-content-between">

                  <button class="btn btn-sm btn-info mb-0 d-none d-lg-block" onclick="return change_password();">Change
                    Password</button>

                  <button class="btn btn-sm btn-info mb-0 d-block d-lg-none" onclick="return change_password();"><i
                      class="ni ni-collection"></i></button>

                  &nbsp;

                  <button class="btn btn-sm btn-dark float-right mb-0 d-none d-lg-block"
                    onclick="return change_profile();">Change Profile</button>

                  <button class="btn btn-sm btn-dark float-right mb-0 d-block d-lg-none"
                    onclick="return change_profile();"><i class="ni ni-email-83"></i></button>

                </div>
              </div>

              <!-- ================= basic details vala ==================== -->

              <div class="card-body pt-0">


                <div class="row">
                  <div class="col">
                    <div class="d-flex justify-content-center">
                      <div class="d-grid text-center">
                        <span class="text-lg font-weight-bolder">-</span>
                        <span class="text-sm opacity-8">Quizes</span>
                      </div>
                      <div class="d-grid text-center mx-4">
                        <span class="text-lg font-weight-bolder">
                          {{ total_submissions }}</span>
                        <span class="text-sm opacity-8">Assignments</span>
                      </div>
                      <div class="d-grid text-center">
                        <span class="text-lg font-weight-bolder">-</span>
                        <span class="text-sm opacity-8">Tests</span>
                      </div>
                    </div>
                  </div>
                </div>


                <div class="text-center mt-4">
                  <h5>
                    {{ student.first_name }} {{ student.last_name }}<span class="font-weight-light">,
                      <small> {{ student.gender }}</small> </span>
                  </h5>
                  <div class="h6 font-weight-300">
                    <i class="ni location_pin mr-2"></i>
                    {% if student.country %}{{student.country}}{% else %} NA {% endif %},
                    {% if student.city %}{{student.city}}{% else %} NA {% endif %}
                  </div>
                  <div class="h6 mt-4">
                    <i class="ni business_briefcase-24 mr-2"></i>

                    - {% for subject in student.subjects.all %}
                    {{ subject.name }} -
                    {% endfor %}
                    <br>
                    Enthusiast


                  </div>
                  <div>
                    <i class="ni education_hat mr-2"></i>GLA University, Mathura
                  </div>
                </div>

              </div>

            </div>

            <!-- ============ change password vala ====================== -->

            <div class="row card-body pt-0" id="change_password_form" style="display: none;">

              <form action="{% url 'change_password' %}" method="post">

                {% csrf_token %}

                <div class="col-md-12">
                  <div class="form-group">
                    <label for="example-text-input" class="form-control-label">Old Password</label>
                    <input class="form-control" type="password" name="old_password" placeholder="Old Password..."
                      required>
                  </div>
                </div>

                <div class="col-md-12">
                  <div class="form-group">
                    <label for="example-text-input" class="form-control-label">New Password</label>
                    <input class="form-control" type="password" name="new_password" placeholder="New Password..."
                      required>
                  </div>
                </div>

                <div class="col-md-12">
                  <div class="form-group">
                    <label for="example-text-input" class="form-control-label">Confirm New Password</label>
                    <input class="form-control" type="password" name="confirm_password"
                      placeholder="Confirm Password..." required>
                  </div>
                </div>

                <div class="d-flex justify-content-between">
                  <button class="btn btn-sm btn-success mb-0 d-none d-lg-block" type="submit">Change Password</button>
                  <button class="btn btn-sm btn-danger mb-0 d-none d-lg-block"
                    onclick="return cancel_change_password();">Cancel</button>
                </div>

              </form>

            </div>

            <!-- ====================== edit profile vala ==================== -->

            <div class="row card-body pt-0" id="change_profile_form" style="display: none;">
              <br>
              <button class="btn btn-sm btn-outline-primary float-right mb-0 d-none d-lg-block"
                onclick="return edit_profile_pic();">Change Profile
                Picture</button>
              <br>
              <button class="btn btn-sm btn-outline-secondary float-right mb-0 d-none d-lg-block"
                onclick="return edit_banner_image();">Change Banner
                Image</button>

              <br>

              <button class="btn btn-sm btn-danger float-right mb-0 d-none d-lg-block"
                onclick="return cancel_edit_profile();">Cancel</button>

            </div>

            <!-- ======================= edit profile_pic ==================== -->

            <div class="row card-body pt-0" id="edit_profile_form" style="display: none;">
              <br>

              <form action="{% url 'update_profile_pic' %}" method="post" enctype="multipart/form-data">

                <br>

                {% csrf_token %}
                <label for="select_profile_pic">Select Profile Picture</label>
                <input type="file" id="select_profile_pic"
                  class="btn btn-sm btn-outline-primary float-right mb-0 d-none d-lg-block" name="profile_pic" required>
                <br>

                <div class="d-flex justify-content-between">
                  <button class="btn btn-sm btn-success mb-0 d-none d-lg-block" type="submit">Save Changes</button>

                  <button class="btn btn-sm btn-danger mb-0 d-none d-lg-block"
                    onclick="return cancel_edit_profile();">Cancel</button>
                </div>


              </form>

            </div>

            <!-- ======================= edit banner image ==================== -->

            <div class="row card-body pt-0" id="edit_banner_form" style="display: none;">
              <br>

              <form action="{% url 'update_banner_image' %}" method="post" enctype="multipart/form-data">

                <br>

                {% csrf_token %}
                <label for="select_profile_pic">Select Banner Image</label>
                <input type="file" id="select_profile_pic"
                  class="btn btn-sm btn-outline-primary float-right mb-0 d-none d-lg-block" name="banner_image"
                  required>
                <br>

                <div class="d-flex justify-content-between">
                  <button class="btn btn-sm btn-success mb-0 d-none d-lg-block" type="submit">Save Changes</button>

                  <button class="btn btn-sm btn-danger mb-0 d-none d-lg-block"
                    onclick="return cancel_edit_profile();">Cancel</button>
                </div>


              </form>
            </div>

          </div>

          <button type="button" class="btn btn-sm btn-danger mt-3 w-100 d-lg-block" data-bs-toggle="modal"
            data-bs-target="#exampleModal">
            Stop Learning (Delete Account)
          </button>

          <!-- Modal -->
          <div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel"
            aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content">
                <div class="modal-header">
                  <h1 class="modal-title fs-5" id="exampleModalLabel">Firse Soch Le!</h1>
                  <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                  Do You Really Want To Delete Your Account?
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                  <a href="{% url 'delete_account' %}" class="btn btn-danger">Yes</a>
                </div>
              </div>
            </div>
          </div>

        </div>

      </div>
    </div>

    <!--   Core JS Files   -->
    <script src="js/core/popper.min.js"></script>
    <script src="js/core/bootstrap.min.js"></script>
    <script src="{% static 'js/core/bootstrap.min.js' %}"></script>
    <script src="js/plugins/perfect-scrollbar.min.js"></script>
    <script src="js/plugins/smooth-scrollbar.min.js"></script>
    <script>
      var win = navigator.platform.indexOf('Win') > -1;
      if (win && document.querySelector('#sidenav-scrollbar')) {
        var options = {
          damping: '0.5'
        }
        Scrollbar.init(document.querySelector('#sidenav-scrollbar'), options);
      }
    </script>

    <script>
      function change_password() {
        document.getElementById("main_card").style.display = "none";
        console.log("none vala done");

        document.getElementById("change_password_form").style.display = "block";

        console.log("block vala done");
      }

      function cancel_change_password() {
        document.getElementById("main_card").style.display = "block";
        console.log("block vala done");

        document.getElementById("change_password_form").style.display = "none";

        console.log("none vala done");
      }

      function change_profile() {
        document.getElementById("main_card").style.display = "none";
        console.log("none vala done");

        document.getElementById("change_profile_form").style.display = "block";

        console.log("block vala done");
      }

      function cancel_edit_profile() {
        document.getElementById("main_card").style.display = "block";
        console.log("block vala done");

        document.getElementById("change_profile_form").style.display = "none";

        console.log("none vala done");
      }

      function edit_profile_pic() {

        // close the change profile form and open the edit profile form

        document.getElementById("change_profile_form").style.display = "none";
        console.log("none vala done");

        document.getElementById("edit_profile_form").style.display = "block";
        console.log("block vala done");

      }

      function edit_banner_image() {

        // close the change profile form and open the edit profile form

        document.getElementById("change_profile_form").style.display = "none";
        console.log("none vala done");

        document.getElementById("edit_banner_form").style.display = "block";
        console.log("block vala done");

      }

      function cancel_edit_profile() {

        // close everything

        document.getElementById("change_profile_form").style.display = "none";
        console.log("none vala done");

        document.getElementById("edit_profile_form").style.display = "none";
        console.log("none vala done");

        document.getElementById("edit_banner_form").style.display = "none";
        document.getElementById("main_card").style.display = "block";


      }
    </script>
    <!-- Github buttons -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    <!-- Control Center for Soft Dashboard: parallax effects, scripts for the example pages etc -->
    <script src="js/argon-dashboard.min.js"></script>
</body>

</html>